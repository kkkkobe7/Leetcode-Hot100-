# 20. 有效的括号

解题思路拆解

**1. 核心直觉：后进先出 (LIFO)**
*   想象你在吃一串冰糖葫芦或者洗一叠盘子：最后一个放上去的，必须是最先被拿走的。
*   在括号匹配中，**最后出现的左括号，必须最先被对应的右括号匹配掉**。
*   例如：对于 `{[()]}`，最后看到的左括号是 `(`，那么紧接着出现的第一个右括号必须是 `)`。

**2. 算法流程：维护一个“等待匹配”的清单**
*   我们准备一个栈 `st`，用来存放还没遇到另一半的左括号。
*   **遇到左括号**（如 `(`, `[`, `{`）：直接扔进栈里，等待未来被匹配。
*   **遇到右括号**（如 `)`, `]`, `}`）：
    *   **检查栈空**：如果此时栈是空的，说明这个右括号没有对应的左括号（比如 `())`），直接返回 `false`。
    *   **检查匹配**：看栈顶的那个左括号是不是跟自己是一对。
        *   如果是：匹配成功，把栈顶的左括号弹出来（`pop`）。
        *   如果不是：顺序不对或类型不符（比如 `(]`），直接返回 `false`。

**3. 最终判定**
*   当字符串遍历完了，我们要检查栈是否为空。
*   如果为空，说明所有左括号都找到了对象，返回 `true`。
*   如果不为空，说明有些左括号还在“单相思”（比如 `(()`），返回 `false`。

简洁版代码：

```c++
class Solution {
public:
    bool isValid(string s) {
        stack<char> st;
        for (char c: s)
        {
            if (c == ')')
            {
                if (!st.empty() && st.top() == '(') st.pop();
                else return false;
            }
            else if (c == ']')
            {
                if (!st.empty() && st.top() == '[') st.pop();
                else return false;
            }
            else if (c == '}')
            {
                if (!st.empty() && st.top() == '{') st.pop();
                else return false;
            }
            else st.push(c);
        }
        return st.empty();
    }
};
```

注释版代码：

```
class Solution {
public:
    bool isValid(string s) {
        // 创建一个栈，用于存放左括号
        stack<char> st;

        // 遍历字符串中的每一个字符
        for (char c : s)
        {
            // 1. 如果遇到右括号 ')'
            if (c == ')')
            {
                // 必须满足：栈不为空（有左括号待匹配）且 栈顶恰好是对应的左括号 '('
                if (!st.empty() && st.top() == '(') 
                    st.pop(); // 匹配成功，移除栈顶
                else 
                    return false; // 否则，无效
            }
            // 2. 如果遇到右括号 ']'
            else if (c == ']')
            {
                if (!st.empty() && st.top() == '[') 
                    st.pop();
                else 
                    return false;
            }
            // 3. 如果遇到右括号 '}'
            else if (c == '}')
            {
                if (!st.empty() && st.top() == '{') 
                    st.pop();
                else 
                    return false;
            }
            // 4. 如果是左括号，直接压入栈中
            else 
            {
                st.push(c);
            }
        }
        
        // 最后检查栈是否清空。只有全部匹配完才是有效字符串
        return st.empty();
    }
};
```

